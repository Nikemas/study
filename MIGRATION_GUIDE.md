# üîÑ –ì–ê–ô–î –ü–û –ú–ò–ì–†–ê–¶–ò–ò V1 ‚Üí V2

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï
1. [–û–±–∑–æ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏](#–æ–±–∑–æ—Ä-–º–∏–≥—Ä–∞—Ü–∏–∏)
2. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏](#–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–∫-–º–∏–≥—Ä–∞—Ü–∏–∏)
3. [–ü–æ—à–∞–≥–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è](#–ø–æ—à–∞–≥–æ–≤–∞—è-–º–∏–≥—Ä–∞—Ü–∏—è)
4. [–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞](#–ø—Ä–∏–º–µ—Ä—ã-–∫–æ–¥–∞)
5. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
6. [–û—Ç–∫–∞—Ç (Rollback)](#–æ—Ç–∫–∞—Ç)

---

## üéØ –û–ë–ó–û–† –ú–ò–ì–†–ê–¶–ò–ò

### –ß—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è?

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | V1 | V2 | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|-----------|----|----|-----------|
| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö | `courseData.js` (–ø–ª–æ—Å–∫–∞—è) | `stages/` (–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è) | –ü–æ–ª–Ω–∞—è —Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è |
| –ù–∞–≤–∏–≥–∞—Ü–∏—è | –°–≤–æ–±–æ–¥–Ω–∞—è –ø–æ –∫—É—Ä—Å–∞–º | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø–æ —ç—Ç–∞–ø–∞–º | –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ |
| –ü—Ä–æ–≥—Ä–µ—Å—Å | –ü–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º | –ü–æ —ç—Ç–∞–ø–∞–º/–ø–æ–¥—ç—Ç–∞–ø–∞–º | –ù–æ–≤–∞—è —Å—Ö–µ–º–∞ |
| –ü—Ä–∞–∫—Ç–∏–∫–∞ | –û—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ | –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –ø–æ–¥—ç—Ç–∞–ø—ã | –°–≤—è–∑–∫–∞ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ |
| UI | KnowledgeView | LearningView + StageContent | –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã |

### –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è?

- ‚úÖ Chat –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- ‚úÖ Header (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è)
- ‚úÖ Gamification —Å–∏—Å—Ç–µ–º–∞ (–∞–¥–∞–ø—Ç–∞—Ü–∏—è)
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–æ–≤
- ‚úÖ AI —Å–µ—Ä–≤–∏—Å—ã

### –í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞

```
Week 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ + —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã v2
Week 2: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Learning
Week 3: –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö + —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
Week 4: UI –ø–æ–ª–∏—Ä–æ–≤–∫–∞ + –∑–∞–ø—É—Å–∫
```

---

## üõ†Ô∏è –ü–û–î–ì–û–¢–û–í–ö–ê –ö –ú–ò–ì–†–ê–¶–ò–ò

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞

```bash
# –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É –¥–ª—è V2
git checkout -b feature/v2-migration

# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
cp -r src/data src/data-backup-v1
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–ø–æ–∫ V2

```bash
# –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É
mkdir -p src/data/v1
mkdir -p src/data/v2/stages
mkdir -p src/data/v2/achievements
mkdir -p src/data/v2/design
mkdir -p migrations
```

### –®–∞–≥ 3: –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ v1
mv src/data/courseData.js src/data/v1/
mv src/data/achievements.js src/data/v1/
mv src/data/practiceTasksData.js src/data/v1/
```

---

## üìù –ü–û–®–ê–ì–û–í–ê–Ø –ú–ò–ì–†–ê–¶–ò–Ø

### –≠–¢–ê–ü 1: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —ç—Ç–∞–ø–æ–≤

**–§–∞–π–ª**: `src/data/v2/stages/stagesConfig.js`

```javascript
// –ò–º–ø–æ—Ä—Ç—ã —ç—Ç–∞–ø–æ–≤ (–±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –ø–æ–∑–∂–µ)
import htmlStage from './stage-html';
import cssStage from './stage-css';
import javascriptStage from './stage-javascript';
import advancedStage from './stage-advanced';
import projectsStage from './stage-projects';

// –í—Å–µ —ç—Ç–∞–ø—ã –æ–±—É—á–µ–Ω–∏—è
export const LEARNING_STAGES = [
  htmlStage,
  cssStage,
  javascriptStage,
  advancedStage,
  projectsStage
];

// –•–µ–ª–ø–µ—Ä—ã
export const getStageById = (stageId) => {
  return LEARNING_STAGES.find(stage => stage.id === stageId);
};

export const getSubstageById = (stageId, substageId) => {
  const stage = getStageById(stageId);
  if (!stage) return null;
  return stage.substages.find(sub => sub.id === substageId);
};

export const getNextStage = (currentStageId) => {
  const currentIndex = LEARNING_STAGES.findIndex(s => s.id === currentStageId);
  if (currentIndex === -1 || currentIndex === LEARNING_STAGES.length - 1) {
    return null;
  }
  return LEARNING_STAGES[currentIndex + 1];
};

export const getPreviousStage = (currentStageId) => {
  const currentIndex = LEARNING_STAGES.findIndex(s => s.id === currentStageId);
  if (currentIndex <= 0) return null;
  return LEARNING_STAGES[currentIndex - 1];
};
```

### –≠–¢–ê–ü 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —ç—Ç–∞–ø–∞ (HTML)

**–§–∞–π–ª**: `src/data/v2/stages/stage-html/index.js`

```javascript
import metadata from './metadata';
import substages from './substages';

const htmlStage = {
  ...metadata,
  substages
};

export default htmlStage;
```

**–§–∞–π–ª**: `src/data/v2/stages/stage-html/metadata.js`

```javascript
export default {
  id: 'html',
  order: 1,
  title: 'HTML - –û—Å–Ω–æ–≤—ã –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü',
  description: '–ù–∞—É—á–∏—Ç–µ—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü —Å –ø–æ–º–æ—â—å—é HTML',
  icon: 'üìÑ',
  color: 'bg-orange-500',
  estimatedHours: 12,
  prerequisites: [],
  unlockCriteria: {
    previousStageCompletion: 0, // –ü–µ—Ä–≤—ã–π —ç—Ç–∞–ø –≤—Å–µ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç
    minimumScore: 0
  }
};
```

**–§–∞–π–ª**: `src/data/v2/stages/stage-html/substages.js`

```javascript
// –ò–º–ø–æ—Ä—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
import htmlBasics from './materials/01-basics';
import htmlStructure from './materials/02-structure';
import htmlTextElements from './materials/03-text-elements';
// ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã

// –ò–º–ø–æ—Ä—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π
import practiceFirstPage from './practice/task-html-1';
import practiceResume from './practice/task-html-2';
// ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã

export default [
  {
    id: 'html-basics',
    order: 1,
    title: '–ß—Ç–æ —Ç–∞–∫–æ–µ HTML?',
    type: 'theory',
    estimatedMinutes: 30,
    materials: [htmlBasics],
    completionCriteria: {
      readMaterial: true,
      passQuiz: false,
      completePractice: false
    }
  },
  {
    id: 'html-structure',
    order: 2,
    title: '–ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞',
    type: 'theory',
    estimatedMinutes: 45,
    materials: [htmlStructure],
    completionCriteria: {
      readMaterial: true,
      passQuiz: false,
      completePractice: false
    }
  },
  {
    id: 'html-practice-1',
    order: 3,
    title: '–ü—Ä–∞–∫—Ç–∏–∫–∞: –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É',
    type: 'practice',
    estimatedMinutes: 30,
    practice: practiceFirstPage,
    completionCriteria: {
      readMaterial: false,
      passQuiz: false,
      completePractice: true
    }
  },
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–¥—ç—Ç–∞–ø—ã
];
```

**–§–∞–π–ª**: `src/data/v2/stages/stage-html/materials/01-basics.js`

```javascript
export default {
  id: 'html-basics-intro',
  topic: '–ß—Ç–æ —Ç–∞–∫–æ–µ HTML?',
  content: `HTML (HyperText Markup Language) - —ç—Ç–æ —è–∑—ã–∫ —Ä–∞–∑–º–µ—Ç–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü.
HTML –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–≥–∏ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞.`,

  detailedContent: `
## –ß—Ç–æ —Ç–∞–∫–æ–µ HTML?

HTML - —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ –ª—é–±–æ–π –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã. –û–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –ø–æ–º–æ—â—å—é —Ç–µ–≥–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:

- **–¢–µ–≥–∏**: HTML –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–≥–∏, –∑–∞–∫–ª—é—á–µ–Ω–Ω—ã–µ –≤ —É–≥–ª–æ–≤—ã–µ —Å–∫–æ–±–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä \`<html>\`, \`<body>\`, \`<p>\`
- **–≠–ª–µ–º–µ–Ω—Ç—ã**: –ü–∞—Ä–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–≥–æ –∏ –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–≥–æ —Ç–µ–≥–æ–≤ —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º –º–µ–∂–¥—É –Ω–∏–º–∏
- **–ê—Ç—Ä–∏–±—É—Ç—ã**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —ç–ª–µ–º–µ–Ω—Ç–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä \`class="container"\`

HTML –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —è–∑—ã–∫–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è - —ç—Ç–æ —è–∑—ã–∫ —Ä–∞–∑–º–µ—Ç–∫–∏. –û–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
  `.trim(),

  examples: [
    {
      title: '–ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ HTML –¥–æ–∫—É–º–µ–Ω—Ç–∞',
      code: `<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ—è –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</title>
</head>
<body>
    <h1>–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!</h1>
    <p>–≠—Ç–æ –º–æ—è –ø–µ—Ä–≤–∞—è HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞.</p>
</body>
</html>`,
      explanation: `
- \`<!DOCTYPE html>\` - –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (HTML5)
- \`<html>\` - –∫–æ—Ä–Ω–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç
- \`<head>\` - –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- \`<body>\` - –≤–∏–¥–∏–º–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      `.trim()
    },
    {
      title: '–ü—Ä–∏–º–µ—Ä HTML —Ç–µ–≥–æ–≤',
      code: `<!-- –ó–∞–≥–æ–ª–æ–≤–∫–∏ -->
<h1>–ì–ª–∞–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫</h1>
<h2>–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫</h2>

<!-- –ü–∞—Ä–∞–≥—Ä–∞—Ñ -->
<p>–≠—Ç–æ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–µ.</p>

<!-- –°—Å—ã–ª–∫–∞ -->
<a href="https://example.com">–ü–æ—Å–µ—Ç–∏—Ç–µ –Ω–∞—à —Å–∞–π—Ç</a>

<!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
<img src="photo.jpg" alt="–û–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ç–æ">`,
      explanation: '–ü—Ä–∏–º–µ—Ä—ã –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö HTML —Ç–µ–≥–æ–≤'
    }
  ],

  keyPoints: [
    'HTML - —è–∑—ã–∫ —Ä–∞–∑–º–µ—Ç–∫–∏, –Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è',
    '–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–≥–∏ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞',
    '–ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å <!DOCTYPE html>',
    '–¢–µ–≥–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã',
    '–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞: html > head + body'
  ],

  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
  visualAssets: [
    '/design/v2/diagrams/html-structure.svg'
  ]
};
```

**–§–∞–π–ª**: `src/data/v2/stages/stage-html/practice/task-html-1.js`

```javascript
export default {
  id: 'task-html-first-page',
  title: '–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é HTML —Å—Ç—Ä–∞–Ω–∏—Ü—É',
  scenario: `–í—ã —Å–æ–∑–¥–∞–µ—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—É - —Å—Ç—Ä–∞–Ω–∏—Ü—É "–û–±–æ –º–Ω–µ".
–û–Ω–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –±–∞–∑–æ–≤—É—é HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º, –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ —Å–ø–∏—Å–∫–æ–º –≤–∞—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤.`,

  language: 'html',
  difficulty: 'easy',

  starterCode: `<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–û–±–æ –º–Ω–µ</title>
</head>
<body>
    <!-- –í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å -->

</body>
</html>`,

  requirements: [
    '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–≥ <h1> –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ "–û–±–æ –º–Ω–µ"',
    '–î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ (<p>) —Å –∫–æ—Ä–æ—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ —Å–µ–±–µ',
    '–°–æ–∑–¥–∞–π—Ç–µ –Ω–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ (<ul>) —Å –º–∏–Ω–∏–º—É–º 3 –ø—É–Ω–∫—Ç–∞–º–∏ –≤–∞—à–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤',
    '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–µ–≥–∏'
  ],

  hints: [
    '–ù–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é <ul>, –∞ –∫–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç - —Å –ø–æ–º–æ—â—å—é <li>',
    '–ù–µ –∑–∞–±—É–¥—å—Ç–µ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–µ —Ç–µ–≥–∏!',
    '–¢–µ–≥–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–ª–æ–∂–µ–Ω—ã'
  ],

  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (hidden –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
  hiddenChecks: [
    {
      id: 'has_h1',
      type: 'must_contain',
      rule: '<h1>',
      weight: 20,
      message: '–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ h1'
    },
    {
      id: 'has_paragraph',
      type: 'must_contain',
      rule: '<p>',
      weight: 20,
      message: '–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–∞—Ä–∞–≥—Ä–∞—Ñ'
    },
    {
      id: 'has_list',
      type: 'must_contain',
      rule: '<ul>',
      weight: 20,
      message: '–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –Ω–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫'
    },
    {
      id: 'has_list_items',
      type: 'regex',
      rule: '(<li>.*?</li>.*?){3,}',
      weight: 20,
      message: '–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 3 –ø—É–Ω–∫—Ç–∞ —Å–ø–∏—Å–∫–∞'
    },
    {
      id: 'proper_nesting',
      type: 'validation',
      rule: 'checkHTMLNesting',
      weight: 20,
      message: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ —Ç–µ–≥–æ–≤'
    }
  ],

  // –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ –¥–ª—è AI
  rubric: [
    {
      id: 'correctness',
      maxScore: 40,
      description: '–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—ã'
    },
    {
      id: 'completeness',
      maxScore: 30,
      description: '–í—ã–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è'
    },
    {
      id: 'semantics',
      maxScore: 20,
      description: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ–≥–æ–≤'
    },
    {
      id: 'code_quality',
      maxScore: 10,
      description: '–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞'
    }
  ],

  maxAttempts: 3,
  passScore: 70,

  // –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è (—Å–∫—Ä—ã—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
  solutionExample: `<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–û–±–æ –º–Ω–µ</title>
</head>
<body>
    <h1>–û–±–æ –º–Ω–µ</h1>
    <p>
        –ü—Ä–∏–≤–µ—Ç! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ê–ª–µ–∫—Å–µ–π, —è –Ω–∞—á–∏–Ω–∞—é—â–∏–π –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫.
        –ò–∑—É—á–∞—é HTML, CSS –∏ JavaScript –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–µ–±-—Å–∞–π—Ç–æ–≤.
    </p>
    <h2>–ú–æ–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã:</h2>
    <ul>
        <li>–í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞</li>
        <li>–ß—Ç–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∫–Ω–∏–≥</li>
        <li>–ò–≥—Ä–∞ –Ω–∞ –≥–∏—Ç–∞—Ä–µ</li>
        <li>–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</li>
    </ul>
</body>
</html>`
};
```

### –≠–¢–ê–ü 3: –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ V2

**–§–∞–π–ª**: `src/data/v2/index.js`

```javascript
// –≠–∫—Å–ø–æ—Ä—Ç —ç—Ç–∞–ø–æ–≤
export { LEARNING_STAGES, getStageById, getSubstageById, getNextStage, getPreviousStage } from './stages/stagesConfig';

// –≠–∫—Å–ø–æ—Ä—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π V2
export { ACHIEVEMENTS_V2 } from './achievements/achievementsV2';

// –≠–∫—Å–ø–æ—Ä—Ç –¥–∏–∑–∞–π–Ω —Ç–æ–∫–µ–Ω–æ–≤
export { DESIGN_TOKENS } from './design/designTokens';
export { STAGE_DESIGNS } from './design/stageDesigns';

// –£—Ç–∏–ª–∏—Ç—ã
export { calculateStageProgress } from './utils/progressHelpers';
export { checkUnlockCriteria } from './utils/unlockHelpers';
```

### –≠–¢–ê–ü 4: –°–æ–∑–¥–∞–Ω–∏–µ LearningProgressContext

**–§–∞–π–ª**: `src/contexts/LearningProgressContext.jsx`

```javascript
import React, { createContext, useContext, useState, useEffect } from 'react';
import { LEARNING_STAGES } from '../data/v2';
import { storageService } from '../services/storageService';

const LearningProgressContext = createContext();

export const useLearningProgress = () => {
  const context = useContext(LearningProgressContext);
  if (!context) {
    throw new Error('useLearningProgress must be used within LearningProgressProvider');
  }
  return context;
};

export const LearningProgressProvider = ({ children }) => {
  const [userProgress, setUserProgress] = useState(null);
  const [loading, setLoading] = useState(true);

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
  useEffect(() => {
    initializeProgress();
  }, []);

  const initializeProgress = () => {
    let progress = storageService.getUserProgress();

    if (!progress) {
      // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å
      progress = createInitialProgress();
      storageService.saveUserProgress(progress);
    }

    setUserProgress(progress);
    setLoading(false);
  };

  const createInitialProgress = () => {
    return {
      userId: 'user-' + Date.now(),
      currentStage: 'html',
      stages: LEARNING_STAGES.map((stage, index) => ({
        stageId: stage.id,
        status: index === 0 ? 'in_progress' : 'locked',
        completionPercentage: 0,
        startedAt: index === 0 ? new Date().toISOString() : null,
        completedAt: null,
        substages: stage.substages.map((substage) => ({
          substageId: substage.id,
          status: 'locked',
          materialRead: false,
          practiceAttempts: 0,
          practiceScore: 0,
          quizScore: null,
          timeSpent: 0,
          completedAt: null
        })),
        achievements: []
      })),
      stats: {
        totalTimeSpent: 0,
        totalXP: 0,
        level: 1,
        streak: 0,
        completedPractices: 0
      }
    };
  };

  const updateSubstageProgress = (stageId, substageId, updates) => {
    setUserProgress(prev => {
      const newProgress = { ...prev };
      const stageIndex = newProgress.stages.findIndex(s => s.stageId === stageId);
      const substageIndex = newProgress.stages[stageIndex].substages
        .findIndex(s => s.substageId === substageId);

      newProgress.stages[stageIndex].substages[substageIndex] = {
        ...newProgress.stages[stageIndex].substages[substageIndex],
        ...updates
      };

      // –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å —ç—Ç–∞–ø–∞
      recalculateStageProgress(newProgress, stageId);

      // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
      storageService.saveUserProgress(newProgress);

      return newProgress;
    });
  };

  const completeSubstage = (stageId, substageId, score = null) => {
    updateSubstageProgress(stageId, substageId, {
      status: 'completed',
      completedAt: new Date().toISOString(),
      practiceScore: score || 100
    });

    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–¥—ç—Ç–∞–ø–∞
    unlockNextSubstage(stageId, substageId);
  };

  const unlockNextSubstage = (stageId, currentSubstageId) => {
    const stage = LEARNING_STAGES.find(s => s.id === stageId);
    const currentIndex = stage.substages.findIndex(s => s.id === currentSubstageId);

    if (currentIndex < stage.substages.length - 1) {
      const nextSubstageId = stage.substages[currentIndex + 1].id;

      updateSubstageProgress(stageId, nextSubstageId, {
        status: 'in_progress'
      });
    }
  };

  const recalculateStageProgress = (progress, stageId) => {
    const stageIndex = progress.stages.findIndex(s => s.stageId === stageId);
    const stage = progress.stages[stageIndex];

    const completedCount = stage.substages.filter(s => s.status === 'completed').length;
    const totalCount = stage.substages.length;

    stage.completionPercentage = Math.round((completedCount / totalCount) * 100);

    // –ï—Å–ª–∏ —ç—Ç–∞–ø –∑–∞–≤–µ—Ä—à–µ–Ω –Ω–∞ 100%, —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π
    if (stage.completionPercentage === 100) {
      stage.status = 'completed';
      stage.completedAt = new Date().toISOString();

      // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø
      if (stageIndex < progress.stages.length - 1) {
        progress.stages[stageIndex + 1].status = 'in_progress';
        progress.stages[stageIndex + 1].startedAt = new Date().toISOString();
        progress.currentStage = progress.stages[stageIndex + 1].stageId;
      }
    } else if (stage.completionPercentage >= 80 && stageIndex < progress.stages.length - 1) {
      // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø –ø—Ä–∏ 80% –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
      if (progress.stages[stageIndex + 1].status === 'locked') {
        progress.stages[stageIndex + 1].status = 'in_progress';
        progress.stages[stageIndex + 1].startedAt = new Date().toISOString();
      }
    }
  };

  const getStageProgress = (stageId) => {
    if (!userProgress) return null;
    return userProgress.stages.find(s => s.stageId === stageId);
  };

  const getSubstageProgress = (stageId, substageId) => {
    const stage = getStageProgress(stageId);
    if (!stage) return null;
    return stage.substages.find(s => s.substageId === substageId);
  };

  const value = {
    userProgress,
    loading,
    updateSubstageProgress,
    completeSubstage,
    getStageProgress,
    getSubstageProgress
  };

  return (
    <LearningProgressContext.Provider value={value}>
      {children}
    </LearningProgressContext.Provider>
  );
};
```

### –≠–¢–ê–ü 5: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ LearningView

**–§–∞–π–ª**: `src/components/Learning/LearningView.jsx`

```javascript
import React, { useState } from 'react';
import { LEARNING_STAGES } from '../../data/v2';
import { useLearningProgress } from '../../contexts/LearningProgressContext';
import StageNavigator from './StageNavigator';
import StageContent from './StageContent';

const LearningView = () => {
  const { userProgress, loading } = useLearningProgress();
  const [selectedStageId, setSelectedStageId] = useState(
    userProgress?.currentStage || 'html'
  );

  if (loading) {
    return <div className="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>;
  }

  const selectedStage = LEARNING_STAGES.find(s => s.id === selectedStageId);
  const stageProgress = userProgress.stages.find(s => s.stageId === selectedStageId);

  return (
    <div className="learning-view">
      <StageNavigator
        stages={LEARNING_STAGES}
        selectedStageId={selectedStageId}
        onSelectStage={setSelectedStageId}
        userProgress={userProgress}
      />

      <StageContent
        stage={selectedStage}
        stageProgress={stageProgress}
      />
    </div>
  );
};

export default LearningView;
```

**–§–∞–π–ª**: `src/components/Learning/StageContent.jsx`

```javascript
import React, { useState } from 'react';
import SubstageCard from './SubstageCard';
import MaterialViewer from './MaterialViewer';
import PracticeZone from './PracticeZone';
import ProgressBar from './ProgressBar';
import LockOverlay from './LockOverlay';

const StageContent = ({ stage, stageProgress }) => {
  const [selectedSubstage, setSelectedSubstage] = useState(null);

  const isLocked = stageProgress.status === 'locked';

  if (isLocked) {
    return (
      <LockOverlay
        reason="–≠—Ç–æ—Ç —ç—Ç–∞–ø –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
        requirement="–ó–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —ç—Ç–∞–ø –º–∏–Ω–∏–º—É–º –Ω–∞ 80%"
      />
    );
  }

  return (
    <div className="stage-content">
      {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —ç—Ç–∞–ø–∞ */}
      <div className="stage-header">
        <div className="stage-icon">{stage.icon}</div>
        <div>
          <h1>{stage.title}</h1>
          <p>{stage.description}</p>
        </div>
      </div>

      {/* –ü—Ä–æ–≥—Ä–µ—Å—Å */}
      <ProgressBar
        current={stageProgress.completionPercentage}
        total={100}
        label={`${stageProgress.completionPercentage}% –∑–∞–≤–µ—Ä—à–µ–Ω–æ`}
      />

      <div className="stage-info">
        <span>
          –ó–∞–≤–µ—Ä—à–µ–Ω–æ: {stageProgress.substages.filter(s => s.status === 'completed').length}
          –∏–∑ {stage.substages.length} –ø–æ–¥—ç—Ç–∞–ø–æ–≤
        </span>
        <span>
          –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è: ~{stage.estimatedHours} —á–∞—Å–æ–≤
        </span>
      </div>

      {/* –°–ø–∏—Å–æ–∫ –ø–æ–¥—ç—Ç–∞–ø–æ–≤ */}
      <div className="substages-list">
        {stage.substages.map((substage, index) => {
          const substageProgress = stageProgress.substages[index];

          return (
            <SubstageCard
              key={substage.id}
              substage={substage}
              progress={substageProgress}
              onSelect={() => setSelectedSubstage(substage)}
              isSelected={selectedSubstage?.id === substage.id}
            />
          );
        })}
      </div>

      {/* –ü—Ä–æ—Å–º–æ—Ç—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –∏–ª–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞ */}
      {selectedSubstage && (
        <div className="substage-viewer">
          {selectedSubstage.type === 'theory' && (
            <MaterialViewer
              substage={selectedSubstage}
              stageId={stage.id}
              onComplete={() => {
                // –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
                setSelectedSubstage(null);
              }}
            />
          )}

          {selectedSubstage.type === 'practice' && (
            <PracticeZone
              task={selectedSubstage.practice}
              stageId={stage.id}
              substageId={selectedSubstage.id}
              onComplete={() => {
                setSelectedSubstage(null);
              }}
            />
          )}
        </div>
      )}
    </div>
  );
};

export default StageContent;
```

### –≠–¢–ê–ü 6: –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–∏

**–§–∞–π–ª**: `src/services/migrationService.js`

```javascript
import { storageService } from './storageService';
import { LEARNING_STAGES } from '../data/v2';

// –ú–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ä—ã—Ö –∫—É—Ä—Å–æ–≤ –Ω–∞ –Ω–æ–≤—ã–µ —ç—Ç–∞–ø—ã
const V1_TO_V2_MAPPING = {
  courses: {
    html: {
      stageId: 'html',
      materials: {
        // –°—Ç–∞—Ä—ã–π ID –º–∞—Ç–µ—Ä–∏–∞–ª–∞: –Ω–æ–≤—ã–π ID –ø–æ–¥—ç—Ç–∞–ø–∞
        '1': 'html-basics',
        '2': 'html-structure',
        '3': 'html-text-elements'
        // ... –∏ —Ç.–¥.
      }
    },
    css: {
      stageId: 'css',
      materials: {
        '1': 'css-selectors',
        '2': 'css-box-model'
      }
    },
    javascript: {
      stageId: 'javascript',
      materials: {}
    }
  },
  practice: {
    task_html_1: 'html-practice-1',
    task_css_1: 'css-practice-1'
  }
};

export class MigrationService {
  /**
   * –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω—É–∂–Ω–∞ –ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è
   */
  static needsMigration() {
    const v1Data = this.loadV1Data();
    const migrationCompleted = localStorage.getItem('migration_v1_to_v2_completed');

    return v1Data !== null && migrationCompleted !== 'true';
  }

  /**
   * –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ V1 –∏–∑ localStorage
   */
  static loadV1Data() {
    try {
      const knowledgeProgress = localStorage.getItem('knowledgeProgress');
      const practiceProgress = localStorage.getItem('practiceProgress');
      const userStats = localStorage.getItem('userStats');

      if (!knowledgeProgress && !practiceProgress) {
        return null;
      }

      return {
        knowledgeProgress: knowledgeProgress ? JSON.parse(knowledgeProgress) : {},
        practiceProgress: practiceProgress ? JSON.parse(practiceProgress) : {},
        userStats: userStats ? JSON.parse(userStats) : {}
      };
    } catch (error) {
      console.error('Error loading V1 data:', error);
      return null;
    }
  }

  /**
   * –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø V1 –¥–∞–Ω–Ω—ã—Ö
   */
  static createBackup(v1Data) {
    const backup = {
      timestamp: new Date().toISOString(),
      data: v1Data
    };

    localStorage.setItem('v1_backup', JSON.stringify(backup));
    console.log('‚úÖ V1 data backed up');
  }

  /**
   * –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å V1 ‚Üí V2
   */
  static convertProgressV1toV2(v1Data) {
    const { knowledgeProgress, practiceProgress, userStats } = v1Data;

    // –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É V2
    const v2Progress = {
      userId: 'user-' + Date.now(),
      currentStage: 'html',
      stages: [],
      stats: {
        totalTimeSpent: userStats.totalTimeSpent || 0,
        totalXP: userStats.xp || 0,
        level: userStats.level || 1,
        streak: userStats.streak || 0,
        completedPractices: 0
      }
    };

    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø
    LEARNING_STAGES.forEach((stage, stageIndex) => {
      const v1CourseId = this.findV1CourseId(stage.id);
      const v1CourseProgress = knowledgeProgress[v1CourseId] || {};

      const stageProgressData = {
        stageId: stage.id,
        status: stageIndex === 0 ? 'in_progress' : 'locked',
        completionPercentage: 0,
        startedAt: stageIndex === 0 ? new Date().toISOString() : null,
        completedAt: null,
        substages: [],
        achievements: []
      };

      // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥—ç—Ç–∞–ø—ã
      stage.substages.forEach((substage) => {
        const v1MaterialId = this.findV1MaterialId(stage.id, substage.id);
        const isRead = v1CourseProgress.readMaterials?.includes(v1MaterialId);

        const substageProgressData = {
          substageId: substage.id,
          status: isRead ? 'completed' : 'locked',
          materialRead: isRead || false,
          practiceAttempts: 0,
          practiceScore: 0,
          quizScore: null,
          timeSpent: 0,
          completedAt: isRead ? new Date().toISOString() : null
        };

        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–∫—Ç–∏–∫—É
        if (substage.type === 'practice' && substage.practice) {
          const v1PracticeId = this.findV1PracticeId(substage.practice.id);
          const v1PracticeResult = practiceProgress[v1PracticeId];

          if (v1PracticeResult) {
            substageProgressData.practiceAttempts = v1PracticeResult.attempts || 1;
            substageProgressData.practiceScore = v1PracticeResult.score || 0;
            substageProgressData.status = v1PracticeResult.passed ? 'completed' : 'in_progress';
            substageProgressData.completedAt = v1PracticeResult.completedAt;
          }
        }

        stageProgressData.substages.push(substageProgressData);
      });

      // –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞
      const completedCount = stageProgressData.substages.filter(
        s => s.status === 'completed'
      ).length;
      stageProgressData.completionPercentage = Math.round(
        (completedCount / stageProgressData.substages.length) * 100
      );

      // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–µ–∫—É—â–∏–π —ç—Ç–∞–ø
      if (stageProgressData.completionPercentage > 0 &&
          stageProgressData.completionPercentage < 100) {
        v2Progress.currentStage = stage.id;
      }

      v2Progress.stages.push(stageProgressData);
    });

    return v2Progress;
  }

  /**
   * –ù–∞–π—Ç–∏ ID –∫—É—Ä—Å–∞ V1 –ø–æ ID —ç—Ç–∞–ø–∞ V2
   */
  static findV1CourseId(v2StageId) {
    for (const [v1CourseId, mapping] of Object.entries(V1_TO_V2_MAPPING.courses)) {
      if (mapping.stageId === v2StageId) {
        return v1CourseId;
      }
    }
    return null;
  }

  /**
   * –ù–∞–π—Ç–∏ ID –º–∞—Ç–µ—Ä–∏–∞–ª–∞ V1 –ø–æ ID –ø–æ–¥—ç—Ç–∞–ø–∞ V2
   */
  static findV1MaterialId(v2StageId, v2SubstageId) {
    const v1CourseId = this.findV1CourseId(v2StageId);
    if (!v1CourseId) return null;

    const courseMapping = V1_TO_V2_MAPPING.courses[v1CourseId];
    if (!courseMapping) return null;

    for (const [v1MaterialId, v2SubId] of Object.entries(courseMapping.materials)) {
      if (v2SubId === v2SubstageId) {
        return v1MaterialId;
      }
    }

    return null;
  }

  /**
   * –ù–∞–π—Ç–∏ ID –ø—Ä–∞–∫—Ç–∏–∫–∏ V1 –ø–æ ID –ø—Ä–∞–∫—Ç–∏–∫–∏ V2
   */
  static findV1PracticeId(v2PracticeId) {
    for (const [v1PracticeId, v2PracId] of Object.entries(V1_TO_V2_MAPPING.practice)) {
      if (v2PracId === v2PracticeId) {
        return v1PracticeId;
      }
    }
    return null;
  }

  /**
   * –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
   */
  static async migrate() {
    console.log('üîÑ Starting V1 ‚Üí V2 migration...');

    try {
      // 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω—É–∂–Ω–∞ –ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è
      if (!this.needsMigration()) {
        console.log('‚ÑπÔ∏è No migration needed');
        return { success: true, message: 'No V1 data found or migration already completed' };
      }

      // 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å V1 –¥–∞–Ω–Ω—ã–µ
      const v1Data = this.loadV1Data();
      console.log('üì¶ V1 data loaded');

      // 3. –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
      this.createBackup(v1Data);

      // 4. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
      const v2Progress = this.convertProgressV1toV2(v1Data);
      console.log('‚úÖ Progress converted to V2 format');

      // 5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å V2 –¥–∞–Ω–Ω—ã–µ
      storageService.saveUserProgress(v2Progress);
      console.log('üíæ V2 data saved');

      // 6. –ü–æ–º–µ—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—É—é
      localStorage.setItem('migration_v1_to_v2_completed', 'true');
      localStorage.setItem('migration_v1_to_v2_date', new Date().toISOString());

      console.log('üéâ Migration completed successfully!');

      return {
        success: true,
        message: 'Migration completed successfully',
        v2Progress
      };

    } catch (error) {
      console.error('‚ùå Migration failed:', error);

      return {
        success: false,
        message: 'Migration failed: ' + error.message,
        error
      };
    }
  }

  /**
   * –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å V1 –¥–∞–Ω–Ω—ã–µ)
   */
  static rollback() {
    try {
      const backup = localStorage.getItem('v1_backup');

      if (!backup) {
        return { success: false, message: 'No backup found' };
      }

      const { data } = JSON.parse(backup);

      // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å V1 –¥–∞–Ω–Ω—ã–µ
      localStorage.setItem('knowledgeProgress', JSON.stringify(data.knowledgeProgress));
      localStorage.setItem('practiceProgress', JSON.stringify(data.practiceProgress));
      localStorage.setItem('userStats', JSON.stringify(data.userStats));

      // –£–¥–∞–ª–∏—Ç—å V2 –¥–∞–Ω–Ω—ã–µ
      localStorage.removeItem('userProgress_v2');
      localStorage.removeItem('migration_v1_to_v2_completed');

      console.log('‚Ü©Ô∏è Rollback completed');

      return { success: true, message: 'Rollback completed' };

    } catch (error) {
      console.error('Rollback failed:', error);
      return { success: false, message: 'Rollback failed: ' + error.message };
    }
  }
}
```

### –≠–¢–ê–ü 7: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ App.jsx

**–§–∞–π–ª**: `src/App.jsx`

```javascript
import React, { useEffect, useState } from 'react';
import { LearningProgressProvider } from './contexts/LearningProgressContext';
import { MigrationService } from './services/migrationService';
import LearningView from './components/Learning/LearningView';
// ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã

function App() {
  const [migrationStatus, setMigrationStatus] = useState('checking');

  useEffect(() => {
    // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
    checkAndMigrate();
  }, []);

  const checkAndMigrate = async () => {
    if (MigrationService.needsMigration()) {
      console.log('Migration needed, starting...');
      const result = await MigrationService.migrate();

      if (result.success) {
        setMigrationStatus('completed');
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
        showNotification('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–æ –≤–µ—Ä—Å–∏–∏ 2.0!');
      } else {
        setMigrationStatus('failed');
        console.error('Migration failed:', result.message);
      }
    } else {
      setMigrationStatus('not_needed');
    }
  };

  if (migrationStatus === 'checking') {
    return <div>–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>;
  }

  return (
    <LearningProgressProvider>
      <div className="App">
        {/* ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ */}

        {currentView === 'learning' && <LearningView />}

        {/* ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ */}
      </div>
    </LearningProgressProvider>
  );
}

export default App;
```

---

## ‚úÖ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ß–µ–∫-–ª–∏—Å—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

```
[ ] V1 –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
[ ] –ë—ç–∫–∞–ø —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π
[ ] –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è
[ ] –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –ø—Ä–∞–∫—Ç–∏–∫–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è
[ ] XP –∏ —É—Ä–æ–≤–Ω–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
[ ] –¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
[ ] V2 –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage
[ ] –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ
[ ] –û—Ç–∫–∞—Ç (rollback) —Ä–∞–±–æ—Ç–∞–µ—Ç
[ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
```

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
```javascript
// –û—á–∏—Å—Ç–∏—Ç—å localStorage
localStorage.clear();

// –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
// –û–∂–∏–¥–∞–Ω–∏–µ: —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å V2, –ø–µ—Ä–≤—ã–π —ç—Ç–∞–ø HTML —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ú–∏–≥—Ä–∞—Ü–∏—è —Å V1
```javascript
// –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å V1 –¥–∞–Ω–Ω—ã–µ
localStorage.setItem('knowledgeProgress', JSON.stringify({
  html: {
    readMaterials: ['1', '2', '3']
  }
}));

// –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
// –û–∂–∏–¥–∞–Ω–∏–µ: –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, V1 –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è –≤ V2
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
```javascript
// –ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏
MigrationService.rollback();

// –û–∂–∏–¥–∞–Ω–∏–µ: V1 –¥–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã, V2 –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã
```

---

## üîÑ –û–¢–ö–ê–¢ (ROLLBACK)

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
import { MigrationService } from './services/migrationService';

// –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
MigrationService.rollback();

// –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
window.location.reload();
```

### –†—É—á–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

```javascript
// –ü–æ–ª—É—á–∏—Ç—å –±—ç–∫–∞–ø
const backup = JSON.parse(localStorage.getItem('v1_backup'));

// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
localStorage.setItem('knowledgeProgress', JSON.stringify(backup.data.knowledgeProgress));
localStorage.setItem('practiceProgress', JSON.stringify(backup.data.practiceProgress));
localStorage.setItem('userStats', JSON.stringify(backup.data.userStats));

// –£–¥–∞–ª–∏—Ç—å V2 —Ñ–ª–∞–≥
localStorage.removeItem('migration_v1_to_v2_completed');

// –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
window.location.reload();
```

---

## üìä –ü–†–û–í–ï–†–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Dashboard**: –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞—Ä—Ç–∞ —ç—Ç–∞–ø–æ–≤
2. **–ü—Ä–æ–≥—Ä–µ—Å—Å**: –°—Ç–∞—Ä—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω
3. **–¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø**: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å—É V1
4. **XP –∏ —É—Ä–æ–≤–µ–Ω—å**: –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã
5. **–ü—Ä–∞–∫—Ç–∏–∫–∞**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:

1. [ ] –°–æ–∑–¥–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –≤—Å–µ—Ö 5 —ç—Ç–∞–ø–æ–≤
2. [ ] –°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è
3. [ ] –î–æ–±–∞–≤–∏—Ç—å –¥–∏–∑–∞–π–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞
4. [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
5. [ ] –°–æ–±—Ä–∞—Ç—å —Ñ–∏–¥–±–µ–∫ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---
